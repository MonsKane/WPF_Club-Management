<Window x:Class="ClubManagementApp.Views.MemberListView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             Title="Club Members Management"
             WindowStartupLocation="CenterScreen"
             Width="1000" Height="700"
             MinWidth="800" MinHeight="600"
             d:DesignHeight="450" d:DesignWidth="800">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header Row -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="10">
            <TextBlock Text="Club Members" FontSize="18" FontWeight="Bold" VerticalAlignment="Center"/>
            <TextBlock Text="{Binding ClubFilter.Name, StringFormat=' - {0}'}"
                       FontSize="16" FontWeight="SemiBold"
                       Foreground="DarkBlue" VerticalAlignment="Center"/>
            <Button Name="AddMemberButton" Content="Add Member" Width="100" Height="30" Margin="20,0,0,0" Click="AddMemberButton_Click"/>
            <Button Name="RefreshButton" Content="Refresh" Width="80" Height="30" Margin="10,0,0,0" Click="RefreshButton_Click"/>
        </StackPanel>

        <!-- Search and Filter Row -->
        <Grid Grid.Row="1" Margin="10,0,10,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Search Box -->
            <TextBox Grid.Column="0"
                     Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                     Height="30"
                     Padding="8,5"
                     FontSize="14"
                     VerticalAlignment="Center">
                <TextBox.Style>
                    <Style TargetType="TextBox">
                        <Style.Triggers>
                            <Trigger Property="Text" Value="">
                                <Setter Property="Background">
                                    <Setter.Value>
                                        <VisualBrush AlignmentX="Left" AlignmentY="Center" Stretch="None">
                                            <VisualBrush.Visual>
                                                <TextBlock Text="Search members..."
                                                         Foreground="Gray"
                                                         FontSize="14"
                                                         Margin="10,0,0,0"/>
                                            </VisualBrush.Visual>
                                        </VisualBrush>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </TextBox.Style>
            </TextBox>

            <!-- Role Filter -->
            <ComboBox Grid.Column="1"
                      SelectedValue="{Binding SelectedRole}"
                      Width="150"
                      Height="30"
                      Margin="10,0,0,0"
                      Padding="8,5"
                      FontSize="14"
                      VerticalAlignment="Center">
                <ComboBoxItem Content="All Roles" />
                <ComboBoxItem Content="Admin" Tag="0"/>
                <ComboBoxItem Content="ClubOwner" Tag="1"/>
                <ComboBoxItem Content="Member" Tag="2"/>
            </ComboBox>

            <!-- Loading Indicator -->
            <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="10,0,0,0" VerticalAlignment="Center">
                <ProgressBar Width="100" Height="20" IsIndeterminate="True">
                    <ProgressBar.Style>
                        <Style TargetType="ProgressBar">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsLoading}" Value="True">
                                    <Setter Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ProgressBar.Style>
                </ProgressBar>
                <TextBlock Text="Loading..." FontStyle="Italic" FontSize="14" Foreground="Blue" Margin="5,0,0,0">
                    <TextBlock.Style>
                        <Style TargetType="TextBlock">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsLoading}" Value="True">
                                    <Setter Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>
            </StackPanel>
        </Grid>

        <!-- Members Count Display -->
        <Border Grid.Row="2" Background="#F0F9FF" Margin="10,0,10,5" Padding="10,5" CornerRadius="5">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="Total Members: " FontWeight="SemiBold"/>
                <TextBlock Text="{Binding FilteredMembers.Count}" FontWeight="Bold" Foreground="DarkBlue"/>
                <TextBlock Text=" | Showing " Margin="20,0,0,0" FontWeight="SemiBold"/>
                <TextBlock Text="{Binding FilteredMembers.Count}" FontWeight="Bold" Foreground="DarkGreen"/>
                <TextBlock Text=" of " FontWeight="SemiBold"/>
                <TextBlock Text="{Binding Members.Count}" FontWeight="Bold" Foreground="DarkGreen"/>
            </StackPanel>
        </Border>

        <!-- Data Grid -->
        <DataGrid Grid.Row="3"
                  Name="MembersDataGrid"
                  Margin="10"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  ItemsSource="{Binding FilteredMembers}"
                  SelectedItem="{Binding SelectedMember}">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Full Name" Binding="{Binding FullName}" Width="200"/>
                <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="250"/>
                <DataGridTextColumn Header="System Role" Binding="{Binding SystemRole}" Width="120"/>
                <DataGridTextColumn Header="Created Date" Binding="{Binding CreatedAt, StringFormat='{}{0:yyyy-MM-dd}'}" Width="100"/>
                <DataGridTemplateColumn Header="Actions" Width="150">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <Button Content="Edit" Width="50" Height="25" Margin="2" Click="EditMemberButton_Click"/>
                                <Button Content="Remove" Width="60" Height="25" Margin="2" Click="RemoveMemberButton_Click"/>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <StatusBar Grid.Row="4">
            <StatusBarItem>
                <TextBlock Name="StatusTextBlock" Text="Ready"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
